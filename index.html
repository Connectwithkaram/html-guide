<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Roads Service Audit Register – Visual Guide (Enhanced)</title>
  <!-- Note: Keeping system fonts for SharePoint compatibility (no external font calls) -->
  <style>
    /* -----------------------
       Base & Reset-lite
    ----------------------- */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color: #0f172a; /* slate-900 */
      background: linear-gradient(135deg, #e2f3f1 0%, #f1f5f9 45%, #e2e8f0 100%);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    :root {
      --c-bg: #ffffff;
      --c-card: #ffffffee;
      --c-muted: #64748b; /* slate-500 */
      --c-muted-2: #475569; /* slate-600 */
      --c-border: #e2e8f0; /* slate-200 */
      --c-teal: #14b8a6; /* teal-500/600 */
      --c-teal-2: #0d9488; /* teal-600 */
      --radius: 14px;
      --shadow-1: 0 10px 30px rgba(2, 8, 23, 0.06);
      --shadow-2: 0 6px 20px rgba(2, 8, 23, 0.08);
      --step-w: 320px;
    }

    .container { max-width: 1200px; margin: 0 auto; padding: 24px; }

    header {
      position: relative;
      background: var(--c-card);
      border: 1px solid var(--c-border);
      border-radius: var(--radius);
      padding: 24px 24px 14px;
      box-shadow: var(--shadow-1);
      backdrop-filter: saturate(130%) blur(6px);
    }
    .title { font-weight: 800; letter-spacing: -0.02em; margin: 0; font-size: 30px; }
    .subtitle { margin: 6px 0 0; color: var(--c-muted); font-weight: 500; }

    /* Progress Bar */
    .progress-wrap { position: relative; height: 8px; background:#e2e8f0; border-radius: 999px; margin-top: 18px; overflow: hidden; }
    .progress { height: 100%; width: 0%; background: linear-gradient(90deg, #5eead4, var(--c-teal), #2dd4bf); box-shadow: inset 0 0 8px rgba(0,0,0,0.06); transition: width 300ms ease; }

    /* Layout */
    .layout { display: grid; grid-template-columns: 1fr; gap: 24px; margin-top: 24px; }
    @media (min-width: 960px) {
      .layout { grid-template-columns: var(--step-w) 1fr; }
    }

    /* Stepper */
    aside {
      position: sticky; top: 16px; align-self: start;
      border-radius: var(--radius);
      border: 1px solid var(--c-border);
      background: var(--c-card);
      box-shadow: var(--shadow-1);
      overflow: hidden;
    }
    .steps-header { padding: 16px 16px 8px; border-bottom: 1px dashed var(--c-border); }
    .steps-header h3 { margin: 0; font-size: 15px; color: var(--c-muted-2); font-weight: 600; letter-spacing: .02em; text-transform: uppercase; }

    .stepper { display: flex; flex-direction: column; }
    .step { display: grid; grid-template-columns: 44px 1fr; gap: 12px; padding: 14px 16px; cursor: pointer; align-items: center; border-left: 4px solid transparent; position: relative; }
    .step + .step { border-top: 1px solid #f1f5f9; }

    .step:hover { background: #f8fafc; }
    .step:focus { outline: none; }
    .step:focus-visible { box-shadow: 0 0 0 3px rgba(20,184,166,.35) inset; }

    .step-circle {
      display: grid; place-items: center; width: 32px; height: 32px; border-radius: 999px;
      background: #e2e8f0; color: #0f172a; font-weight: 800; font-size: 14px;
      transition: transform .18s ease;
    }
    .step:hover .step-circle { transform: translateY(-1px) scale(1.02); }

    .step-title { font-weight: 700; letter-spacing: -.01em; }
    .step-sub { font-size: 12px; color: var(--c-muted); margin-top: 2px; }

    .step.active {
      background: linear-gradient(180deg, #ffffff, #f8fffd);
      border-left-color: var(--c-teal);
      box-shadow: inset 0 0 0 1px #ecfeff, 0 1px 0 #e2e8f0;
    }
    .step.active .step-circle { background: var(--c-teal); color: white; box-shadow: 0 6px 14px rgba(20,184,166, .35); }
    .step.active .step-title { color: var(--c-teal-2); }

    /* Content Panel */
    main {
      background: var(--c-card);
      border: 1px solid var(--c-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-2);
      padding: 24px;
      min-height: 420px;
      position: relative;
      overflow: hidden;
    }

    /* content transitions */
    .fade-enter { opacity: 0; transform: translateY(6px) scale(.995); }
    .fade-enter-active { opacity: 1; transform: translateY(0) scale(1); transition: opacity 250ms ease, transform 250ms ease; }

    .content-header { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
    .content-title { margin: 0; font-size: 24px; letter-spacing: -0.02em; }

    .content-body { margin-top: 12px; color: #1f2937; }
    .content-body h4 { margin: 18px 0 8px; font-size: 18px; color: #0f172a; }
    .content-body p { margin: 8px 0 16px; color: var(--c-muted-2); }

    .content-image { width: 100%; height: auto; max-height: 420px; object-fit: contain; border-radius: 12px; border: 1px solid var(--c-border); box-shadow: var(--shadow-1); background: #fff; }

    /* Controls */
    .controls { display: flex; align-items: center; justify-content: space-between; gap: 12px; margin-top: 16px; }
    .btn {
      display:inline-flex; align-items:center; gap:10px; cursor:pointer; user-select:none;
      background: #0f172a; color:#ffffff; border:1px solid #0f172a; border-radius: 12px; padding: 10px 14px; font-weight: 700;
      transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
    }
    .btn.secondary { background: #ffffff; color:#0f172a; border-color: var(--c-border); }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 10px 16px rgba(2,8,23, .08); }
    .btn:active { transform: translateY(0); box-shadow: none; }
    .btn[disabled] { opacity: .45; cursor: not-allowed; box-shadow: none; transform: none; }

    /* Tiny badges / chips */
    .chip { display:inline-block; padding: 2px 10px; font-size: 11px; border-radius: 999px; background:#e6fffb; color:#0d9488; border:1px solid #99f6e4; font-weight:700; letter-spacing:.02em; }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce) {
      .fade-enter-active { transition: none; }
      .step-circle, .btn { transition: none; }
      .progress { transition: none; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header aria-label="Guide header">
      <h1 class="title">Roads Service Audit Register</h1>
      <p class="subtitle">A visual, step‑by‑step guide to creating audits, managing findings & actions, and completing verification.</p>
      <div class="progress-wrap" aria-hidden="true"><div id="progress" class="progress"></div></div>
    </header>

    <section class="layout" aria-label="Main layout">
      <!-- Stepper / Sidebar -->
      <aside>
        <div class="steps-header"><h3>Process Timeline</h3></div>
        <nav id="stepper" class="stepper" aria-label="Steps" role="tablist">
          <div id="step-1" class="step" role="tab" tabindex="0" aria-controls="panel-1" aria-selected="true" data-step="1">
            <div class="step-circle">1</div>
            <div>
              <div class="step-title">Create Audit & Finding</div>
              <div class="step-sub">Start the process</div>
            </div>
          </div>
          <div id="step-2" class="step" role="tab" tabindex="0" aria-controls="panel-2" aria-selected="false" data-step="2">
            <div class="step-circle">2</div>
            <div>
              <div class="step-title">Create Action</div>
              <div class="step-sub">Address a finding</div>
            </div>
          </div>
          <div id="step-3" class="step" role="tab" tabindex="0" aria-controls="panel-3" aria-selected="false" data-step="3">
            <div class="step-circle">3</div>
            <div>
              <div class="step-title">Manager Agreement</div>
              <div class="step-sub">Approve & assign approvers</div>
            </div>
          </div>
          <div id="step-4" class="step" role="tab" tabindex="0" aria-controls="panel-4" aria-selected="false" data-step="4">
            <div class="step-circle">4</div>
            <div>
              <div class="step-title">Owner & Verifier Actions</div>
              <div class="step-sub">Complete, evidence, verify</div>
            </div>
          </div>
          <div id="step-5" class="step" role="tab" tabindex="0" aria-controls="panel-5" aria-selected="false" data-step="5">
            <div class="step-circle">5</div>
            <div>
              <div class="step-title">Complete Audit</div>
              <div class="step-sub">Finalize the process</div>
            </div>
          </div>
        </nav>
      </aside>

      <!-- Content Panel -->
      <main id="content-panel" role="tabpanel" aria-live="polite" aria-labelledby="step-1">
        <!-- Content injected via JS -->
      </main>
    </section>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const stepsData = {
        '1': {
          title: 'Section 1: Create Audit & Finding',
          htmlContent: `
            <span class="chip">Audits</span>
            <h4>Create a New Audit</h4>
            <p>Navigate to the <strong>Audits</strong> tab and select <strong>+ New Audit</strong>. Complete key details (Title, Reference, Dates), then select <strong>Save</strong>.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Create%20New%20Audit.png?csf=1&web=1&e=g41yNh" alt="New Audit Screen" class="content-image" />
            <h4>Add a Finding to an Audit</h4>
            <p>Open your newly created audit and select <strong>Edit</strong>. From the audit details, choose <strong>Add Finding</strong> to open the finding form, document the details, then save.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Add%20Finding%20Edit%20button.png?csf=1&web=1&e=uAooNW" alt="Add Finding Button" class="content-image" />
          `
        },
        '2': {
          title: 'Section 2: Create Action',
          htmlContent: `
            <span class="chip">Findings → Actions</span>
            <h4>Create an Action for a Finding</h4>
            <p>In the <strong>Findings</strong> tab, select the <strong>✏️ pencil</strong> on the finding to open details, then add a new action.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Create%20an%20action%20for%20a%20finding.png?csf=1&web=1&e=bEy9gG" alt="Findings List" class="content-image" />
            <p>Give the action a clear title, set a target date, and add notes. Choose <strong>Save Action</strong>. It will now appear in the <strong>Actions</strong> tab.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Save%20action.png?csf=1&web=1&e=77wWUY" alt="New Action Form" class="content-image" />
          `
        },
        '3': {
          title: 'Section 3: Manager Agreement',
          htmlContent: `
            <span class="chip">Actions → Approvals</span>
            <h4>Manager Agreement & Assignment</h4>
            <p>Open the action, go to <strong>Action Responsibility</strong>, then select <strong>+ Add Managers</strong> to assign approvers.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Responsible%20Managers.png?csf=1&web=1&e=G1bYOo" alt="Assign Responsibility Screen" class="content-image" />
            <p>After adding managers, go to <strong>Action Responsibility</strong> and select <strong>Notify</strong> to alert them. When agreed, update approval to <strong>Agreed</strong>, recording who signed off and the date.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Manager%20Agreement.png?csf=1&web=1&e=tbzh1x" alt="Manager Agreement Section" class="content-image" />
            <p>Confirm the agreement by updating the status and capturing sign‑off details.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Manager%20Agreement1.png?csf=1&web=1&e=rDKQhI" alt="Manager Agreement Section 2" class="content-image" />
          `
        },
        '4': {
          title: 'Section 4: Owner & Verifier Actions',
          htmlContent: `
            <span class="chip">Execution & Evidence</span>
            <h4>Owner Actions & Verification</h4>
            <p>Once managers have agreed, assign the task owner. In the action, open <strong>Assign Responsibility</strong>, select <strong>+ Add Owner</strong>, then notify via <strong>Action Responsibility</strong>.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Add%20Owner.png?csf=1&web=1&e=MJdbn5" alt="Assign Owner" class="content-image" />
            <p>The owner completes the task, uploads evidence using <strong>Upload Evidence</strong>, and marks the action as <strong>Completed</strong>. Assign a <strong>Verifier</strong>, who reviews all evidence and marks each verified. When satisfied, the verifier sets the action to <strong>Verified</strong>.</p>
          `
        },
        '5': {
          title: 'Section 5: Complete Audit',
          htmlContent: `
            <span class="chip">Close‑out</span>
            <h4>Completing the Audit</h4>
            <p>All actions linked to the audit must be <strong>Verified</strong>. Return to <strong>Audits</strong>, locate the audit card, and choose <strong>Mark Completed</strong> to close the audit.</p>
            <img src="https://highlandcouncil1.sharepoint.com/:i:/r/sites/RAR/AuditGuideImages/Mark%20Audit%20Complete.png?csf=1&web=1&e=hEOxlr" alt="Mark Audit Completed" class="content-image" />
            <p style="text-align:center; font-weight:800; color:#0d9488; font-size:20px; margin-top: 12px;">✅ Nice! The audit process is complete.</p>
          `
        }
      };

      const stepper = document.getElementById('stepper');
      const contentPanel = document.getElementById('content-panel');
      const progress = document.getElementById('progress');
      const steps = Array.from(stepper.querySelectorAll('.step'));
      const totalSteps = steps.length;
      let current = 1;

      function setProgress(step) {
        const pct = Math.max(0, Math.min(100, (step - 1) / (totalSteps - 1) * 100));
        progress.style.width = pct + '%';
      }

      function updateStepperActive(stepId) {
        steps.forEach(s => s.classList.toggle('active', Number(s.dataset.step) === Number(stepId)));
        steps.forEach(s => s.setAttribute('aria-selected', String(Number(s.dataset.step) === Number(stepId))));
      }

      function renderContent(stepId) {
        const data = stepsData[String(stepId)];
        if (!data) return;

        // set ARIA bindings
        contentPanel.setAttribute('aria-labelledby', 'step-' + stepId);
        contentPanel.id = 'panel-' + stepId;

        // build content with a small transition
        const wrapper = document.createElement('div');
        wrapper.className = 'fade-enter';
        wrapper.innerHTML = `
          <div class="content-header">
            <h2 class="content-title">${data.title}</h2>
            <div class="chip">Step ${stepId} of ${totalSteps}</div>
          </div>
          <div class="content-body">${data.htmlContent}</div>
          <div class="controls">
            <button class="btn secondary" id="prevBtn" ${stepId == 1 ? 'disabled' : ''} aria-label="Previous step">◀ Previous</button>
            <button class="btn" id="nextBtn" ${stepId == totalSteps ? 'disabled' : ''} aria-label="Next step">Next ▶</button>
          </div>
        `;

        contentPanel.innerHTML = '';
        contentPanel.appendChild(wrapper);
        requestAnimationFrame(() => { wrapper.classList.add('fade-enter-active'); });

        // controls
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        prevBtn && prevBtn.addEventListener('click', () => goTo(stepId - 1));
        nextBtn && nextBtn.addEventListener('click', () => goTo(stepId + 1));

        updateStepperActive(stepId);
        setProgress(stepId);
        current = Number(stepId);
      }

      function goTo(stepId) {
        const id = Math.max(1, Math.min(totalSteps, Number(stepId)));
        renderContent(id);
        const active = document.querySelector(`#step-${id}`);
        active && active.focus();
      }

      // Sidebar click + keyboard support
      stepper.addEventListener('click', (e) => {
        const item = e.target.closest('.step');
        if (!item) return;
        goTo(item.dataset.step);
      });

      stepper.addEventListener('keydown', (e) => {
        const item = e.target.closest('.step');
        if (!item) return;
        const step = Number(item.dataset.step);
        if (e.key === 'ArrowDown') { e.preventDefault(); goTo(step + 1); }
        if (e.key === 'ArrowUp')   { e.preventDefault(); goTo(step - 1); }
        if (/^[1-5]$/.test(e.key)) { e.preventDefault(); goTo(Number(e.key)); }
      });

      // Global shortcuts: Alt+N / Alt+P
      document.addEventListener('keydown', (e) => {
        if (e.altKey && (e.key.toLowerCase() === 'n')) { goTo(current + 1); }
        if (e.altKey && (e.key.toLowerCase() === 'p')) { goTo(current - 1); }
      });

      // initial render
      renderContent(1);
      document.getElementById('step-1').classList.add('active');
    });
  </script>
</body>
</html>
